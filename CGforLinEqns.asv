function [x] = CGforLinEqns(A, b, x0, epsilon)

x = x0;
k = 0;

gOld = A*x-b;
d = -gOld;

while (norm(gOld) > epsilon)
    t = (norm(gOld)^2)/(d'*A*d);
    
    x = x + t*d;
    gNew = gOld + t*A*d;
    
    beta = (norm(gNew)^2)/(norm(gOld)^2);
    
    d = -gNew+beta*d;
    
    gOld = gNew;
    
    k = k+1;
    